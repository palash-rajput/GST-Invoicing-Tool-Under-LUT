<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice Generator (India â†’ US Â· Under LUT)</title>

    <!-- Google Fonts - Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        * {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, sans-serif;
}

body {
  margin: 0;
  background: #f6f7f9;
  color: #111;
}

.container {
  display: grid;
  grid-template-columns: 360px 1fr;
  height: 100vh;
}

/* LEFT FORM */
.form-container {
  background: #ffffff;
  padding: 32px;
  padding-bottom: 100px; /* Space for fixed nav with 2 buttons */
  overflow-y: auto;
  border-right: 1px solid #e5e7eb;
  position: relative;
  font-family: Montserrat, sans-serif; /* Match invoice font */
}

.step-indicator {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-bottom: 20px;
  margin-bottom: 24px;
  border-bottom: 2px solid #e5e7eb;
  font-family: Montserrat, sans-serif;
}

.step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  flex: 1;
  cursor: pointer;
  transition: all 0.2s;
}

.step.active .step-number {
  background: #2770f1;
  color: white;
  border-color: #2770f1;
}

.step.active .step-label {
  color: #2770f1;
  font-weight: 600;
}

.step.completed .step-number {
  background: #10b981;
  color: white;
  border-color: #10b981;
}

.step-number {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: 2px solid #d1d5db;
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  color: #6b7280;
  transition: all 0.2s;
}

.step-label {
  font-size: 10px;
  font-weight: 500;
  color: #6b7280;
  text-align: center;
  transition: all 0.2s;
}

.step-divider {
  flex: 0 0 8px;
  height: 2px;
  background: #e5e7eb;
  margin: 0 -2px;
  margin-bottom: 16px;
}

.form-step {
  display: none;
}

.form-step.active {
  display: block;
}

.form-step h2 {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 16px;
  color: #333;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  font-family: Montserrat, sans-serif;
}

label {
  font-family: Montserrat, sans-serif;
  font-size: 12px;
  font-weight: 600;
  color: #333;
  display: block;
  margin-bottom: 5px;
  margin-top: 10px;
}

input,
textarea,
select {
  font-family: Montserrat, sans-serif;
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 12px;
  color: #333;
  line-height: 1.5;
}

input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: #2770f1;
  box-shadow: 0 0 0 3px rgba(39, 112, 241, 0.1);
}

textarea {
  resize: vertical;
  min-height: 70px;
}

.toggle-label {
  margin-top: 12px;
  font-size: 14px;
}

.link-small {
  color: #2770f1;
  font-size: 12px;
  font-family: Montserrat, sans-serif;
  text-decoration: none;
  display: inline-block;
  margin-top: 4px;
}

.link-small:hover {
  text-decoration: underline;
}

.fixed-box {
  background: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 16px;
  margin-top: 20px;
  font-family: Montserrat, sans-serif;
}

.fixed-box p {
  margin: 8px 0;
  font-size: 12px;
  color: #333;
  line-height: 1.6;
}

button#addItemBtn {
  background: #2770f1;
  color: white;
  border: none;
  border-radius: 6px;
  padding: 10px 16px;
  font-family: Montserrat, sans-serif;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 12px;
  transition: background-color 0.2s;
  width: 100%;
}

button#addItemBtn:hover {
  background: #1d5dd8;
}

.form-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 360px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 16px 24px;
  background: #ffffff;
  border-top: 1px solid #e5e7eb;
  border-right: 1px solid #e5e7eb;
  z-index: 10;
}

.form-nav button {
  padding: 12px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-weight: 600;
}

#prevBtn, #nextBtn {
  flex: 1;
}

#prevBtn {
  background: #e5e7eb;
}

#nextBtn {
  background: #111827;
  color: #fff;
}

.hidden {
  display: none;
}

/* TOGGLE SWITCH */
.toggle-switch {
  position: relative;
  width: 50px;
  height: 24px;
  display: inline-block;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  border-radius: 24px;
  transition: 0.3s;
}

.toggle-slider:before {
  content: "";
  position: absolute;
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: 0.3s;
}

input:checked + .toggle-slider {
  background-color: #2770f1;
}

input:checked + .toggle-slider:before {
  transform: translateX(26px);
}

/* RIGHT PREVIEW */
.preview-container {
  background: #f3f4f6;
  overflow-y: auto;
  padding: 40px;
  position: relative;
}

#downloadPdfBtn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  padding: 14px 24px;
  background: #2770f1;
  color: #fff;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 100;
  box-shadow: 0 4px 12px rgba(39, 112, 241, 0.3);
}

#downloadPdfBtn:hover {
  background: #1d5dd8;
  box-shadow: 0 6px 16px rgba(39, 112, 241, 0.4);
}

#invoicePreview {
  background: #ffffff;
  max-width: 900px;
  margin: auto;
  padding: 36px;
  border-radius: 8px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.06);
}

.header-section {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}

.header-right {
  text-align: right;
}

.header-right p {
  margin: 6px 0;
  font-size: 14px;
}

.header-right strong {
  color: #374151;
}

.invoice-label {
  color: #2563eb;
  font-weight: 700;
  font-size: 16px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.header-left h1 {
  margin: 6px 0 12px 0;
  font-size: 32px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.header-left p {
  margin: 6px 0;
  font-size: 14px;
  line-height: 1.5;
  color: #374151;
}

.header-left strong {
  color: #111827;
}

.company-logo {
  max-height: 80px;
  max-width: 80px;
  margin-bottom: 12px;
  display: block;
}

hr {
  margin: 28px 0;
  border: none;
  border-top: 1px solid #e5e7eb;
}

/* BILL + ITEMS */
.bill-items-wrapper {
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: 24px;
}

.bill-to h2 {
  margin: 6px 0;
  font-size: 20px;
  font-weight: 700;
}

.bill-to h3 {
  font-size: 14px;
  font-weight: 600;
  color: #6b7280;
  margin-bottom: 12px;
}

.items-header {
  display: flex;
  justify-content: space-between;
  font-weight: 700;
  padding-bottom: 12px;
  border-bottom: 2px solid #e5e7eb;
}

.items-header h3 {
  font-size: 14px;
  color: #374151;
}

.item-row {
  margin-top: 16px;
}

.item-title {
  font-weight: 600;
}

.amount {
  float: right;
  font-weight: 600;
}

.total-line {
  margin-top: 24px;
  padding-top: 16px;
  border-top: 2px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  font-size: 18px;
  font-weight: 700;
  color: #2563eb;
}

.inr-section {
  margin-top: 16px;
  padding: 12px 0;
  border-top: 1px solid #e5e7eb;
}

.inr-section h4 {
  margin: 0 0 6px 0;
  font-size: 14px;
  font-weight: 600;
  color: #374151;
}

.inr-section span {
  font-size: 16px;
  font-weight: 700;
  color: #111827;
}

.signature-block {
  margin-top: 32px;
  text-align: right;
}

.signature-img {
  max-height: 70px;
}

/* PAYMENT */
.payment-section h3 {
  margin-bottom: 10px;
}

#payNowBtn {
  display: inline-block;
  background: #2563eb;
  color: #fff;
  padding: 16px 32px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 700;
  font-size: 16px;
  transition: background 0.2s;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

#payNowBtn:hover {
  background: #1d4ed8;
}

.small-text {
  font-size: 12px;
  margin-top: 6px;
}

.payment-lower {
  display: flex;
  gap: 24px;
  margin-top: 20px;
}

.qr-img {
  max-width: 120px;
}

.bank-details p {
  margin: 4px 0;
}

.export-declaration {
  margin-top: 24px;
}

.export-declaration h3 {
  font-size: 14px;
  font-weight: 700;
  color: #374151;
  margin-bottom: 8px;
}

.export-declaration p {
  font-size: 14px;
  color: #6b7280;
  line-height: 1.6;
}

/* ===== WEBFLOW INVOICE DESIGN CSS ===== */
#invoicePreview {
  font-family: Montserrat, sans-serif;
  max-width: 960px;
  padding: 32px;
}

#invoicePreview .header {
  flex-flow: row;
  justify-content: space-between;
  display: flex;
  margin-bottom: 24px;
}

#invoicePreview .company-details {
  max-width: 540px;
}

#invoicePreview .div-block-6 {
  display: flex;
  justify-content: flex-end;
  align-items: flex-start;
  flex: 1;
}

#invoicePreview .invoice-details {
  flex-flow: column;
  justify-content: flex-start;
  align-items: flex-end;
  display: flex;
}

#invoicePreview .invoice {
  color: #2770f1;
  text-transform: uppercase;
  margin-bottom: 32px;
  font-size: 16px;
  font-weight: 700;
}

#invoicePreview .company-name {
  text-transform: uppercase;
  margin-bottom: 15px;
  font-size: 32px;
  font-weight: 800;
  line-height: 32px;
}

#invoicePreview .gst-pan {
  grid-column-gap: 20px;
  grid-row-gap: 20px;
  margin-bottom: 8px;
  display: flex;
}

#invoicePreview .text-block {
  color: #333;
  font-size: 13px;
  line-height: 20px;
}

#invoicePreview .text-block.semi {
  font-weight: 600;
}

#invoicePreview .text-block.large {
  font-size: 16px;
  font-weight: 700;
}

#invoicePreview .text-block.large.blue {
  color: #2770f1;
}

#invoicePreview .text-block.small {
  font-size: 10px;
}

#invoicePreview .text-block.small._10-blue {
  color: #2770f1;
  margin-bottom: -2px;
  margin-left: 4px;
}

#invoicePreview .gst, #invoicePreview .pan {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  display: flex;
}

#invoicePreview .address {
  margin-bottom: 8px;
}

#invoicePreview .email-phone {
  grid-column-gap: 20px;
  grid-row-gap: 20px;
  margin-bottom: 0;
  display: flex;
}

#invoicePreview .email, #invoicePreview .phone {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  display: flex;
}

#invoicePreview .logo-container {
  width: 70px;
  height: 70px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

#invoicePreview .company-logo {
  max-width: 70px;
  max-height: 70px;
  object-fit: contain;
}

#invoicePreview .invoice-number, #invoicePreview .invoice-date, #invoicePreview .export-type {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  margin-bottom: 8px;
  display: flex;
}

#invoicePreview .lut-number {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  margin-bottom: 0;
  display: flex;
}

#invoicePreview .divider-line-1 {
  background-color: #3336;
  height: 1px;
  margin-top: 30px;
  margin-bottom: 0;
}

#invoicePreview ._2-part-section {
  display: flex;
}

#invoicePreview .part-1 {
  border-right: 1px solid #3336;
  min-width: 288px;
}

#invoicePreview .part-2 {
  width: 100%;
}

#invoicePreview .bill-to {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  flex-flow: column;
  margin-bottom: 20px;
  display: flex;
}

#invoicePreview .client-company-name {
  font-size: 24px;
  font-weight: 700;
  line-height: 24px;
}

#invoicePreview .contact-person {
  grid-column-gap: 2px;
  grid-row-gap: 2px;
  flex-flow: column;
  margin-bottom: 10px;
  display: flex;
}

#invoicePreview .client-address, #invoicePreview .client-country, #invoicePreview .client-email, #invoicePreview .client-gstin {
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  flex-flow: column;
  margin-bottom: 10px;
  display: flex;
}

#invoicePreview .billing-details {
  border-bottom: 1px solid #3336;
  padding-top: 30px;
  padding-bottom: 30px;
}

#invoicePreview .payment-button {
  border-bottom: 1px #3336;
  flex-flow: column;
  justify-content: center;
  align-items: center;
  padding-top: 30px;
  padding-bottom: 30px;
  display: flex;
}

#invoicePreview .button {
  color: #fff;
  background-color: #2770f1;
  border-radius: 8px;
  justify-content: center;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding: 16px 48px;
  font-size: 16px;
  font-weight: 600;
  line-height: 20px;
  display: inline-flex;
  text-decoration: none;
  transition: background-color 0.2s;
  min-width: 220px;
}

#invoicePreview .button:hover {
  background-color: #1d5dd8;
}

#invoicePreview .services {
  border-bottom: 1px solid #3336;
  flex-flow: column;
  justify-content: space-between;
  padding-top: 30px;
  padding-bottom: 10px;
  padding-left: 32px;
  display: flex;
}

#invoicePreview .nav {
  justify-content: space-between;
  align-items: stretch;
  margin-bottom: 15px;
  display: flex;
}

#invoicePreview .items {
  justify-content: space-between;
  margin-bottom: 40px;
  display: flex;
}

#invoicePreview .service-details {
  grid-column-gap: 12px;
  grid-row-gap: 12px;
  flex-flow: column;
  width: 430px;
  display: flex;
}

#invoicePreview .item-calculation {
  margin-top: 60px;
}

#invoicePreview .total-usd {
  border-bottom: 1px solid #3333331a;
  justify-content: space-between;
  margin-bottom: 12px;
  padding-bottom: 12px;
  display: flex;
}

#invoicePreview .div-block {
  justify-content: flex-start;
  align-items: flex-end;
  display: flex;
}

#invoicePreview .total-inr {
  border-bottom: 1px #3333331a;
  justify-content: space-between;
  padding-bottom: 12px;
  display: flex;
}

#invoicePreview .total-inr-usd {
  margin-bottom: 10px;
}

#invoicePreview .invoice-currency, #invoicePreview .rbi-rate, #invoicePreview .gst-amount, #invoicePreview .gst-rate, #invoicePreview .place-of-supply {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  margin-bottom: 6px;
  display: flex;
}

#invoicePreview .rate-signature {
  justify-content: space-between;
  display: flex;
}

#invoicePreview .signature-container {
  width: 160px;
  height: 91px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 0;
}

#invoicePreview .signature {
  max-width: 160px;
  max-height: 91px;
  transform: rotate(-12deg);
  object-fit: contain;
}

#invoicePreview .signature-detail {
  grid-column-gap: 2px;
  grid-row-gap: 2px;
  flex-flow: column;
  justify-content: center;
  align-items: center;
  margin-bottom: 15px;
  display: flex;
}

#invoicePreview .div-block-2 {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin-top: -9px;
}

#invoicePreview .payment-terms {
  border-bottom: 1px solid #3336;
  padding-top: 30px;
  padding-bottom: 20px;
  padding-left: 32px;
  display: none;
}

#invoicePreview .terms {
  grid-column-gap: 12px;
  grid-row-gap: 6px;
  flex-flow: column;
  margin-bottom: 20px;
  display: flex;
}

#invoicePreview .bank-details {
  padding-bottom: 0;
}

#invoicePreview .bank-details-1 {
  padding-left: 20px;

}

#invoicePreview .payment-info {
  display: flex;
}

#invoicePreview .wise-bank-code {
  min-width: 230px;
  min-height: 230px;
  display: none;
  padding-right: 30px;
}

#invoicePreview .wise-qr {
  width: 230px;
}

#invoicePreview .bank {
  grid-column-gap: 6px;
  grid-row-gap: 6px;
  margin-bottom: 12px;
  display: flex;
}

#invoicePreview .div-block-3 {
  display: flex;
}


#invoicePreview .div-block-5 {
  flex-flow: column;
  justify-content: center;
  align-items: flex-start;
  display: flex;
}

#invoicePreview .declaration {
  border-bottom: 1px #3336;
  padding-top: 30px;
  padding-bottom: 30px;
  padding-left: 32px;
}

#invoicePreview .cost {
  min-width: 130px;
  text-align: right;
}


    </style>
</head>

<body>

<div class="container">

    <!-- LEFT SIDE FORM -->
    <div class="form-container">

        <!-- STEP PROGRESS INDICATOR -->
        <div class="step-indicator">
            <div class="step" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Info</div>
            </div>
            <div class="step-divider"></div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Invoice</div>
            </div>
            <div class="step-divider"></div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Client</div>
            </div>
            <div class="step-divider"></div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Services</div>
            </div>
            <div class="step-divider"></div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">Payment</div>
            </div>
            <div class="step-divider"></div>
            <div class="step" data-step="6">
                <div class="step-number">6</div>
                <div class="step-label">Sign</div>
            </div>
        </div>

        <!-- STEP 1 â€“ YOUR INFORMATION -->
        <div class="form-step active" data-step="1">
            <h2>Your Information</h2>

            <label>Company Name</label>
            <input type="text" id="companyName">

            <label>GSTIN Number</label>
            <input type="text" id="gstin">

            <label>PAN Number</label>
            <input type="text" id="pan">

            <label>Address (Line 1)</label>
            <input type="text" id="companyAddressLine1">

            <label>City</label>
            <input type="text" id="companyCity">

            <label>State</label>
            <input type="text" id="companyState">

            <label>Country</label>
            <input type="text" id="companyCountry">

            <label>Pin Code</label>
            <input type="text" id="companyPinCode">

            <label>Email</label>
            <input type="email" id="companyEmail">

            <label>Phone</label>
            <input type="text" id="companyPhone">

            <label>Company Logo (optional)</label>
            <input type="file" id="companyLogo" accept="image/*">
        </div>

        <!-- STEP 2 â€“ INVOICE DETAILS -->
        <div class="form-step" data-step="2">
            <h2>Invoice Details</h2>

            <label>Invoice Number</label>
            <input type="text" id="invoiceNumber">

            <label>Invoice Date</label>
            <input type="date" id="invoiceDate">

            <label>LUT Number</label>
            <input type="text" id="lutNumber">

            <label>Invoice Currency</label>
            <select id="invoiceCurrency">
                <option value="USD">USD</option>
                <option value="EUR">EUR</option>
                <option value="GBP">GBP</option>
                <option value="AUD">AUD</option>
                <option value="CAD">CAD</option>
            </select>

            <label>RBI Exchange Rate</label>
            <input type="number" id="exchangeRate" step="0.0001">
            <a href="https://www.msei.in/markets/currency/historical-data/rbireferenceratearchives" 
               target="_blank" class="link-small">View Today's Rate</a>

            <label>Place of Supply</label>
            <select id="placeOfSupply">
                <option value="Andhra Pradesh">Andhra Pradesh</option>
                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                <option value="Assam">Assam</option>
                <option value="Bihar">Bihar</option>
                <option value="Chhattisgarh">Chhattisgarh</option>
                <option value="Goa">Goa</option>
                <option value="Gujarat">Gujarat</option>
                <option value="Haryana">Haryana</option>
                <option value="Himachal Pradesh">Himachal Pradesh</option>
                <option value="Jharkhand">Jharkhand</option>
                <option value="Karnataka">Karnataka</option>
                <option value="Kerala">Kerala</option>
                <option value="Madhya Pradesh">Madhya Pradesh</option>
                <option value="Maharashtra">Maharashtra</option>
                <option value="Manipur">Manipur</option>
                <option value="Meghalaya">Meghalaya</option>
                <option value="Mizoram">Mizoram</option>
                <option value="Nagaland">Nagaland</option>
                <option value="Odisha">Odisha</option>
                <option value="Punjab">Punjab</option>
                <option value="Rajasthan">Rajasthan</option>
                <option value="Sikkim">Sikkim</option>
                <option value="Tamil Nadu">Tamil Nadu</option>
                <option value="Telangana">Telangana</option>
                <option value="Tripura">Tripura</option>
                <option value="Uttar Pradesh">Uttar Pradesh</option>
                <option value="Uttarakhand">Uttarakhand</option>
                <option value="West Bengal">West Bengal</option>
            </select>

            <div class="fixed-box">
                <p><strong>Export Type:</strong> Export of Service Under LUT</p>
                <p><strong>GST Rate:</strong> 0%</p>
                <p><strong>GST Amount:</strong> Nil</p>
                <p><strong>IGST Payable:</strong> No</p>
            </div>
        </div>

        <!-- STEP 3 â€“ CLIENT INFORMATION -->
        <div class="form-step" data-step="3">
            <h2>Client Information</h2>

            <label>Client Company Name</label>
            <input type="text" id="clientCompany">

            <label>Contact Person</label>
            <input type="text" id="clientPerson">

            <label>Address (Line 1)</label>
            <input type="text" id="clientAddressLine1">

            <label>State</label>
            <input type="text" id="clientState">

            <label>Country</label>
            <select id="clientCountrySelect">
                <option value="United States of America">United States of America</option>
                <option value="Canada">Canada</option>
                <option value="Australia">Australia</option>
                <option value="United Kingdom">United Kingdom</option>
            </select>

            <label>Pin Code</label>
            <input type="text" id="clientPinCode">

            <label>Email</label>
            <input type="email" id="clientEmail">

            <label>Client GSTIN</label>
            <input type="text" id="clientGSTIN" value="Unregistered / Overseas">
        </div>

        <!-- STEP 4 â€“ SERVICE DETAILS -->
        <div class="form-step" data-step="4">
            <h2>Service Details</h2>

            <div id="itemsContainer"></div>

            <button type="button" id="addItemBtn">+ Add Item</button>
        </div>

        <!-- STEP 5 â€“ PAYMENT TERMS -->
        <div class="form-step" data-step="5">
            <h2>Payment Terms</h2>

            <label>Support Email</label>
            <input type="text" id="supportEmail">

            <label>Due Date (Days)</label>
            <input type="number" id="dueDays">

            <label>Payment Link</label>
            <input type="url" id="paymentLink">

            <div style="display: flex; align-items: center; gap: 12px; margin-top: 12px;">
                <span>Add Bank Details?</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="bankDetailsToggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="bankContainer" class="hidden">
                <label>Bank</label>
                <input type="text" id="bankName">

                <label>Account Holder</label>
                <input type="text" id="bankHolder">

                <label>Account Number</label>
                <input type="text" id="bankNumber">

                <label>IFSC Code</label>
                <input type="text" id="bankIFSC">

                <label>Bank Branch</label>
                <input type="text" id="bankBranch">

                <div style="display: flex; align-items: center; gap: 12px; margin-top: 20px; margin-bottom: 12px;">
                    <span>Add QR Code?</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="qrCodeToggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div id="qrCodeContainer" class="hidden">
                    <label>QR Code</label>
                    <input type="file" id="qrImage" accept="image/*">
                </div>
            </div>
        </div>

        <!-- STEP 6 â€“ SIGNATURE -->
        <div class="form-step" data-step="6">
            <h2>Signature</h2>

            <label>Signature Name</label>
            <input type="text" id="signatureName">

            <label>Signature Title</label>
            <input type="text" id="signatureTitle">

            <label>Upload Signature</label>
            <input type="file" id="signatureImage" accept="image/*">
        </div>

        <!-- NAVIGATION -->
        <div class="form-nav">
            <button id="prevBtn" disabled>Previous</button>
            <button id="nextBtn">Next</button>
        </div>

    </div>

    <!-- RIGHT SIDE PREVIEW -->
    <div class="preview-container">

        <!-- FLOATING DOWNLOAD PDF BUTTON -->
        <button id="downloadPdfBtn">ðŸ“¥ Download PDF</button>

        <div id="invoicePreview">
            <!-- HEADER -->
            <div class="header">
                <div class="company-details">
                    <div class="invoice">Invoice</div>
                    <div class="company-name" id="p-companyName">GOOGLE INDIA PVT LTD</div>
                    <div class="gst-pan">
                        <div class="gst">
                            <div class="text-block">GSTIN:</div>
                            <div class="text-block semi" id="p-gstin">29AABCG5293F1Z5</div>
                        </div>
                        <div class="pan">
                            <div class="text-block">PAN:</div>
                            <div class="text-block semi" id="p-pan">AABCG5293F</div>
                        </div>
                    </div>
                    <div class="address">
                        <div class="text-block" id="p-companyAddress">3rd Floor, RMZ Infinity Tower E<br>Bangalore, Karnataka, India - 560001</div>
                    </div>
                    <div class="email-phone">
                        <div class="email">
                            <div class="text-block">Email:</div>
                            <div class="text-block semi" id="p-companyEmail">invoices@google.com</div>
                        </div>
                        <div class="phone">
                            <div class="text-block">Phone:</div>
                            <div class="text-block semi" id="p-companyPhone">(+91) 80 6744 5000</div>
                        </div>
                    </div>
                </div>
                <div class="div-block-6">
                    <div class="invoice-details">
                        <div class="logo-container">
                            <img id="p-companyLogo" src="" loading="lazy" alt="Company Logo" class="company-logo" style="display: none;">
                        </div>
                        <div class="invoice-number">
                            <div class="text-block">Invoice No:</div>
                            <div class="text-block semi" id="p-invoiceNumber">GOOG-2025-DEC-001</div>
                        </div>
                        <div class="invoice-date">
                            <div class="text-block">Invoice Date:</div>
                            <div class="text-block semi" id="p-invoiceDate">13th December 2025</div>
                        </div>
                        <div class="export-type">
                            <div class="text-block">Export Type:</div>
                            <div class="text-block semi">Export of Service under LUT</div>
                        </div>
                        <div class="lut-number">
                            <div class="text-block">LUT Reference (ARN):</div>
                            <div class="text-block semi" id="p-lut">AD2302220102614</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="divider-line-1"></div>
            <div class="_2-part-section">
                <div class="part-1">
                    <div class="billing-details">
                        <div class="bill-to">
                            <div class="text-block small">BILL TO:</div>
                            <div class="client-company-name" id="p-clientCompany">Microsoft Corporation</div>
                        </div>
                        <div class="contact-person">
                            <div class="text-block small">CONTACT PERSON:</div>
                            <div class="text-block semi" id="p-clientPerson">John Smith</div>
                        </div>
                        <div class="client-address">
                            <div class="text-block small">ADDRESS:</div>
                            <div class="text-block semi" id="p-clientAddress">One Microsoft Way<br>Redmond, WA, United States - 98052</div>
                        </div>
                        <div class="client-country">
                            <div class="text-block small">COUNTRY:</div>
                            <div class="text-block semi" id="p-clientCountry">United States of America</div>
                        </div>
                        <div class="client-email">
                            <div class="text-block small">EMAIL:</div>
                            <div class="text-block semi" id="p-clientEmail">john.smith@microsoft.com</div>
                        </div>
                        <div class="client-gstin">
                            <div class="text-block small">CLIENT GSTIN:</div>
                            <div class="text-block semi" id="p-clientGSTIN">Unregistered / Overseas</div>
                        </div>
                    </div>
                    <div class="payment-button" id="payBtnBlock" style="display: none;">
                        <a href="#" id="payNowBtn" class="button">
                            Proceed to Payment
                        </a>
                        <div class="text-block small">Click to open secure payment link.</div>
                    </div>
                </div>
                <div class="part-2">
                    <div class="services">
                        <div class="item-details">
                            <div class="nav">
                                <div class="text-block small"><strong>ITEMS</strong></div>
                                <div class="text-block small"><strong>AMOUNT</strong></div>
                            </div>
                            <div id="p-items">
                                <!-- Items will be dynamically added here -->
                            </div>
                        </div>
                        <div class="item-calculation">
                            <div class="total-inr-usd">
                                <div class="total-usd">
                                    <div class="div-block">
                                        <div class="text-block large blue">TOTAL</div>
                                        <div class="text-block small _10-blue">(in <span id="p-totalCurrency">USD</span>)</div>
                                    </div>
                                    <div class="div-block">
                                        <div class="text-block large blue" id="p-totalAmount">$1,050 USD</div>
                                    </div>
                                </div>
                                <div class="total-inr">
                                    <div class="div-block">
                                        <div class="text-block large">INR Equivalent:</div>
                                    </div>
                                    <div class="div-block">
                                        <div class="text-block large" id="p-inrAmount">â‚¹94,888.71</div>
                                    </div>
                                </div>
                            </div>
                            <div class="rate-signature">
                                <div>
                                    <div class="invoice-currency">
                                        <div class="text-block">Invoice Currency:</div>
                                        <div class="text-block semi" id="p-cur">USD</div>
                                    </div>
                                    <div class="rbi-rate">
                                        <div class="text-block">RBI Exchange Rate:</div>
                                        <div class="text-block semi" id="p-exRate">90.3702</div>
                                    </div>
                                    <div class="gst-amount">
                                        <div class="text-block">GST Amount:</div>
                                        <div class="text-block semi">Nil</div>
                                    </div>
                                    <div class="gst-rate">
                                        <div class="text-block">GST Rate:</div>
                                        <div class="text-block semi">0% (export under LUT)</div>
                                    </div>
                                    <div class="place-of-supply">
                                        <div class="text-block">Place of Supply:</div>
                                        <div class="text-block semi" id="p-place">Karnataka</div>
                                    </div>
                                </div>
                                <div class="div-block-2">
                                    <div class="signature-container">
                                        <img id="p-signatureImage" src="" loading="lazy" alt="Signature" class="signature" style="display: none;">
                                    </div>
                                    <div class="signature-detail">
                                        <div class="text-block semi" id="p-signatureName">SUNDAR PICHAI</div>
                                        <div class="text-block small" id="p-signatureTitle">Authorized Signatory</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="payment-terms">
                        <div class="terms">
                            <div class="text-block semi">PAYMENT TERMS:</div>
                            <div class="text-block" id="p-paymentText">Payment is due within 30 days from the invoice date. You can pay using the account details below or use the payment link provided. For any questions about this invoice, reach out at invoices@google.com</div>
                        </div>
                        <div class="payment-info">
                            <div class="wise-bank-code">
                                <img id="p-qrImage" src="" loading="lazy" alt="QR Code" class="wise-qr" style="display: none;">
                            </div>
                            <div class="div-block-5">
                                <div class="div-block-4" style="display: none; padding-bottom: 10px;">
                                    <div class="text-block semi"><strong>BANK DETAILS</strong></div>
                                </div>
                                <div class="div-block-3" id="bankDetailsBlock" style="display: none;">
                                    <!-- Bank details will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="declaration">
                        <div class="terms">
                            <div class="text-block semi">EXPORT DECLARATION:</div>
                            <div class="text-block">Supply is meant for export under LUT without payment of IGST. (No IGST Payable)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>

let currentStep = 1;

const steps = document.querySelectorAll(".form-step");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

function showStep(step) {
  steps.forEach(s => s.classList.remove("active"));
  steps[step - 1].classList.add("active");

  prevBtn.disabled = step === 1;
  nextBtn.textContent = step === steps.length ? "Finish" : "Next";

  // Update step indicator
  updateStepIndicator(step);
}

prevBtn.onclick = () => {
  if (currentStep > 1) {
    currentStep--;
    showStep(currentStep);
  }
};

nextBtn.onclick = () => {
  if (currentStep < steps.length) {
    currentStep++;
    showStep(currentStep);
  }
};

// Update step indicator when navigating
function updateStepIndicator(step) {
  const stepIndicators = document.querySelectorAll(".step");
  stepIndicators.forEach((stepEl, index) => {
    const stepNum = index + 1;
    stepEl.classList.remove("active", "completed");

    if (stepNum === step) {
      stepEl.classList.add("active");
    } else if (stepNum < step) {
      stepEl.classList.add("completed");
    }
  });
}

// Add click handlers to steps for navigation
document.querySelectorAll(".step").forEach((stepEl, index) => {
  stepEl.addEventListener("click", () => {
    currentStep = index + 1;
    showStep(currentStep);
  });
});

showStep(currentStep);

/* IMAGE TO BASE64 */
function readImage(input, target) {
  if (!input.files[0]) return;
  const reader = new FileReader();
  reader.onload = () => {
    target.src = reader.result;
    target.style.display = "block";
  };
  reader.readAsDataURL(input.files[0]);
}

/* FIELD â†’ PREVIEW BINDING */
function bind(id, previewId, formatFn) {
  const el = document.getElementById(id);
  el.addEventListener("input", () => {
    document.getElementById(previewId).textContent =
      formatFn ? formatFn(el.value) : el.value;
  });
}

bind("companyName", "p-companyName");
bind("gstin", "p-gstin");
bind("pan", "p-pan");
bind("companyEmail", "p-companyEmail");
bind("companyPhone", "p-companyPhone");

/* Company Address Handler */
function updateCompanyAddress() {
  const line1 = document.getElementById("companyAddressLine1").value;
  const city = document.getElementById("companyCity").value;
  const state = document.getElementById("companyState").value;
  const country = document.getElementById("companyCountry").value;
  const pinCode = document.getElementById("companyPinCode").value;

  const line2Parts = [city, state, country, pinCode].filter(Boolean);
  const line2 = line2Parts.join(", ");

  document.getElementById("p-companyAddress").innerHTML =
    line1 + (line2 ? "<br>" + line2 : "");
}

["companyAddressLine1", "companyCity", "companyState", "companyCountry", "companyPinCode"]
  .forEach(id => {
    document.getElementById(id).addEventListener("input", updateCompanyAddress);
  });
bind("invoiceNumber", "p-invoiceNumber");
bind("invoiceCurrency", "p-currency");
bind("lutNumber", "p-lut");
bind("clientCompany", "p-clientCompany");
bind("clientPerson", "p-clientPerson");
bind("clientEmail", "p-clientEmail");
bind("clientGSTIN", "p-clientGSTIN");
bind("placeOfSupply", "p-place");

/* Client Address Handler */
function updateClientAddress() {
  const line1 = document.getElementById("clientAddressLine1").value;
  const state = document.getElementById("clientState").value;
  const country = document.getElementById("clientCountrySelect").value;
  const pinCode = document.getElementById("clientPinCode").value;

  const line2Parts = [state, country, pinCode].filter(Boolean);
  const line2 = line2Parts.join(", ");

  document.getElementById("p-clientAddress").innerHTML =
    line1 + (line2 ? "<br>" + line2 : "");

  // Also update country in preview header
  document.getElementById("p-clientCountry").textContent = country;
}

["clientAddressLine1", "clientState", "clientCountrySelect", "clientPinCode"]
  .forEach(id => {
    document.getElementById(id).addEventListener("input", updateClientAddress);
  });

document.getElementById("invoiceDate").addEventListener("input", e => {
  const date = new Date(e.target.value);
  const day = date.getDate();
  const ordinal = (day) => {
    const s = ["th", "st", "nd", "rd"];
    const v = day % 100;
    return day + (s[(v - 20) % 10] || s[v] || s[0]);
  };
  const month = date.toLocaleString('en-US', { month: 'long' });
  const year = date.getFullYear();
  document.getElementById("p-invoiceDate").textContent = `${ordinal(day)} ${month} ${year}`;
});

/* LOGO */
document.getElementById("companyLogo").addEventListener("change", e => {
  readImage(e.target, document.getElementById("p-companyLogo"));
});

/* SIGNATURE */
document.getElementById("signatureImage").addEventListener("change", e => {
  readImage(e.target, document.getElementById("p-signatureImage"));
});

bind("signatureName", "p-signatureName");
bind("signatureTitle", "p-signatureTitle");

/* PAYMENT */
document.getElementById("paymentLink").addEventListener("input", e => {
  const link = e.target.value;
  const block = document.getElementById("payBtnBlock");
  const btn = document.getElementById("payNowBtn");

  if (link) {
    btn.href = link;
    block.style.display = "flex";
  } else {
    block.style.display = "none";
  }
});

document.getElementById("bankDetailsToggle").addEventListener("change", e => {
  document.getElementById("bankContainer").classList.toggle("hidden", !e.target.checked);
  const bankBlock = document.getElementById("bankDetailsBlock");
  bankBlock.style.display = e.target.checked ? "flex" : "none";
  const bankLabel = document.querySelector(".div-block-4");
  bankLabel.style.display = e.target.checked ? "block" : "none";
  // Hide entire Payment Terms section when toggle is off
  const paymentTermsSection = document.querySelector(".payment-terms");
  paymentTermsSection.style.display = e.target.checked ? "block" : "none";
});

/* QR CODE TOGGLE */
document.getElementById("qrCodeToggle").addEventListener("change", e => {
  document.getElementById("qrCodeContainer").classList.toggle("hidden", !e.target.checked);
  const qrImg = document.getElementById("p-qrImage");
  const qrContainer = document.querySelector(".wise-bank-code");
  if (!e.target.checked) {
    qrImg.style.display = "none";
    qrContainer.style.display = "none";
  } else {
    qrContainer.style.display = "block";
  }
});

/* CURRENCY SYMBOL HELPER */
function getCurrencySymbol(currency) {
  const symbols = {
    'USD': '$',
    'EUR': 'â‚¬',
    'GBP': 'Â£',
    'AUD': 'A$',
    'CAD': 'C$'
  };
  return symbols[currency] || currency;
}

/* INR NUMBER FORMATTER (Indian numbering system) */
function formatINR(number) {
  if (!number || isNaN(number)) return "0.00";

  // Convert to string and split into integer and decimal parts
  const parts = number.toFixed(2).split(".");
  const integerPart = parts[0];
  const decimalPart = parts[1];

  // Indian numbering system: last 3 digits, then groups of 2
  let formatted = "";
  const length = integerPart.length;

  if (length <= 3) {
    formatted = integerPart;
  } else {
    // Last 3 digits
    formatted = integerPart.slice(-3);
    let remaining = integerPart.slice(0, -3);

    // Add commas every 2 digits from right to left
    while (remaining.length > 0) {
      if (remaining.length <= 2) {
        formatted = remaining + "," + formatted;
        remaining = "";
      } else {
        formatted = remaining.slice(-2) + "," + formatted;
        remaining = remaining.slice(0, -2);
      }
    }
  }

  return formatted + "." + decimalPart;
}

/* ITEMS */
const itemsContainer = document.getElementById("itemsContainer");
const previewItems = document.getElementById("p-items");

document.getElementById("addItemBtn").onclick = () => {
  const idx = document.querySelectorAll(".item").length + 1;

  const div = document.createElement("div");
  div.className = "item";
  div.innerHTML = `
    <label>Title</label><input class="title">
    <label>Description</label><textarea class="desc"></textarea>
    <label>SAC</label><input class="sac">
    <label>Amount</label><input type="number" class="amt">
    <button type="button" class="delete-item-btn" style="background: #ef4444; color: white; border: none; border-radius: 4px; padding: 8px 16px; cursor: pointer; font-size: 12px; font-weight: 600; margin-top: 12px; width: 100%;">Delete Item</button>
    <hr>
  `;
  itemsContainer.appendChild(div);

  div.querySelectorAll("input,textarea").forEach(i =>
    i.addEventListener("input", updateItems)
  );

  // Add delete button handler
  div.querySelector(".delete-item-btn").addEventListener("click", () => {
    div.remove();
    updateItems();
  });
};

function updateItems() {
  previewItems.innerHTML = "";
  let total = 0;
  const currency = document.getElementById("invoiceCurrency").value;
  const currencySymbol = getCurrencySymbol(currency);

  document.querySelectorAll(".item").forEach(item => {
    const title = item.querySelector(".title").value;
    const desc = item.querySelector(".desc").value;
    const sac = item.querySelector(".sac").value;
    const amt = Number(item.querySelector(".amt").value || 0);
    total += amt;

    previewItems.innerHTML += `
      <div class="items">
        <div class="service-details">
          <div class="text-block large">${title}</div>
          <div class="text-block">${desc}</div>
          <div class="phone">
            <div class="text-block">SAC:</div>
            <div class="text-block semi">${sac}</div>
          </div>
        </div>
        <div class="cost">
          <div class="text-block large">${currencySymbol}${amt.toFixed(2)} ${currency}</div>
        </div>
      </div>
    `;
  });

  document.getElementById("p-totalCurrency").textContent = currency;
  document.getElementById("p-totalAmount").textContent = currencySymbol + total.toFixed(2) + " " + currency;
  document.getElementById("p-cur").textContent = currency;

  const rate = Number(document.getElementById("exchangeRate").value || 0);
  const inrTotal = total * rate;
  document.getElementById("p-exRate").textContent = rate;
  document.getElementById("p-inrAmount").textContent =
    "â‚¹ " + formatINR(inrTotal);
}

/* UPDATE PAYMENT TERMS TEXT */
function updatePaymentTerms() {
  const supportEmail = document.getElementById("supportEmail").value;
  const dueDays = document.getElementById("dueDays").value;
  const paymentText = document.getElementById("p-paymentText");

  if (dueDays && supportEmail) {
    paymentText.textContent = `Payment is due within ${dueDays} days from the invoice date. You can pay using the account details below or use the payment link provided. For any questions about this invoice, reach out at ${supportEmail}`;
  } else {
    paymentText.textContent = "Payment terms will appear here once you fill the required fields.";
  }
}

document.getElementById("supportEmail").addEventListener("input", updatePaymentTerms);
document.getElementById("dueDays").addEventListener("input", updatePaymentTerms);

/* UPDATE BANK DETAILS */
function updateBankDetails() {
  const bankName = document.getElementById("bankName").value;
  const bankHolder = document.getElementById("bankHolder").value;
  const bankNumber = document.getElementById("bankNumber").value;
  const bankIFSC = document.getElementById("bankIFSC").value;
  const bankBranch = document.getElementById("bankBranch").value;
  const bankBlock = document.getElementById("bankDetailsBlock");

  if (bankName || bankHolder || bankNumber) {
    bankBlock.innerHTML = `
      <div class="bank-details">
        <div class="bank"><div class="text-block">Bank:</div></div>
        <div class="bank"><div class="text-block">Account Holder:</div></div>
        <div class="bank"><div class="text-block">Account Number:</div></div>
        <div class="bank"><div class="text-block">IFSC Code:</div></div>
        <div class="bank"><div class="text-block">Bank Branch:</div></div>
      </div>
      <div class="bank-details-1">
        <div class="bank"><div class="text-block semi"><strong>${bankName}</strong></div></div>
        <div class="bank"><div class="text-block semi"><strong>${bankHolder}</strong></div></div>
        <div class="bank"><div class="text-block semi"><strong>${bankNumber}</strong></div></div>
        <div class="bank"><div class="text-block semi"><strong>${bankIFSC}</strong></div></div>
        <div class="bank"><div class="text-block semi"><strong>${bankBranch}</strong></div></div>
      </div>
    `;
  }
}

document.getElementById("bankName").addEventListener("input", updateBankDetails);
document.getElementById("bankHolder").addEventListener("input", updateBankDetails);
document.getElementById("bankNumber").addEventListener("input", updateBankDetails);
document.getElementById("bankIFSC").addEventListener("input", updateBankDetails);
document.getElementById("bankBranch").addEventListener("input", updateBankDetails);

document.getElementById("qrImage").addEventListener("change", e => {
  const qrImg = document.getElementById("p-qrImage");
  const qrContainer = document.querySelector(".wise-bank-code");
  readImage(e.target, qrImg);
  // Show QR container when image is uploaded
  if (e.target.files[0]) {
    qrContainer.style.display = "block";
  }
});

/* EXCHANGE RATE UPDATE */
document.getElementById("exchangeRate").addEventListener("input", updateItems);
document.getElementById("invoiceCurrency").addEventListener("input", updateItems);

/* PDF DOWNLOAD FUNCTIONALITY */
document.getElementById("downloadPdfBtn").addEventListener("click", async function() {
  const button = this;
  const originalText = button.textContent;
  button.textContent = "Generating PDF...";
  button.disabled = true;

  try {
    const invoice = document.getElementById("invoicePreview");

    // Store original styles
    const originalMaxWidth = invoice.style.maxWidth;
    const originalPadding = invoice.style.padding;

    // Temporarily set to full width with no padding for PDF
    invoice.style.maxWidth = '1000px';  // Original Webflow design width
    invoice.style.padding = '40px';

    // Wait for reflow
    await new Promise(resolve => setTimeout(resolve, 100));

    // Use html2canvas to capture the invoice with higher quality
    const canvas = await html2canvas(invoice, {
      scale: 3,              // Increased from 2 to 3 for better quality
      useCORS: true,
      logging: false,
      backgroundColor: "#ffffff",
      letterRendering: true  // Preserve letter spacing
    });

    // Restore original styles immediately
    invoice.style.maxWidth = originalMaxWidth;
    invoice.style.padding = originalPadding;

    // A4 page dimensions - use full width (no margins)
    const pageWidth = 210;    // A4 width in mm
    const pageHeight = 297;   // A4 height in mm

    // Calculate image dimensions to fill page width
    let imgWidth = pageWidth;
    let imgHeight = (canvas.height * imgWidth) / canvas.width;

    // If content exceeds page height, add multiple pages
    let position = 0;
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: "portrait",
      unit: "mm",
      format: "a4"
    });

    const imgData = canvas.toDataURL("image/png");

    // Add image to fill full page width
    if (imgHeight <= pageHeight) {
      // Single page - center vertically
      const yOffset = (pageHeight - imgHeight) / 2;
      pdf.addImage(imgData, "PNG", 0, yOffset, imgWidth, imgHeight);
    } else {
      // Multiple pages needed
      while (position < canvas.height) {
        const pageCanvas = document.createElement('canvas');
        pageCanvas.width = canvas.width;
        pageCanvas.height = Math.min(
          canvas.height - position,
          (pageHeight / imgWidth) * canvas.width
        );

        const ctx = pageCanvas.getContext('2d');
        ctx.drawImage(
          canvas,
          0, position,
          canvas.width, pageCanvas.height,
          0, 0,
          pageCanvas.width, pageCanvas.height
        );

        const pageData = pageCanvas.toDataURL("image/png");
        const pageImgHeight = (pageCanvas.height * imgWidth) / pageCanvas.width;

        if (position > 0) {
          pdf.addPage();
        }

        pdf.addImage(pageData, "PNG", 0, 0, imgWidth, pageImgHeight);

        position += pageCanvas.height;
      }
    }

    // Generate filename from invoice number
    const invoiceNum = document.getElementById("invoiceNumber").value || "invoice";
    const filename = `${invoiceNum.replace(/\s+/g, '-')}.pdf`;

    pdf.save(filename);

    button.textContent = "âœ“ Downloaded!";
    setTimeout(() => {
      button.textContent = originalText;
      button.disabled = false;
    }, 2000);
  } catch (error) {
    console.error("PDF generation failed:", error);
    button.textContent = "Error - Try Again";
    setTimeout(() => {
      button.textContent = originalText;
      button.disabled = false;
    }, 2000);
  }
});

/* LOAD SAMPLE DATA */
function loadSampleData() {
  // Step 1: Your Information
  document.getElementById("companyName").value = "Google India Pvt Ltd";
  document.getElementById("gstin").value = "29AABCG5293F1Z5";
  document.getElementById("pan").value = "AABCG5293F";
  document.getElementById("companyAddressLine1").value = "3, Old Madras Rd, Sadanandanagar, Bennigana Halli,";
  document.getElementById("companyCity").value = "Bangalore";
  document.getElementById("companyState").value = "Karnataka";
  document.getElementById("companyCountry").value = "India";
  document.getElementById("companyPinCode").value = "560001";
  document.getElementById("companyEmail").value = "invoices@google.com";
  document.getElementById("companyPhone").value = "(+91) 80 6744 5000";

  // Step 2: Invoice + Currency + GST + LUT
  document.getElementById("invoiceNumber").value = "GOOG-2025-DEC-001";
  document.getElementById("invoiceDate").value = "2025-12-13";
  document.getElementById("lutNumber").value = "AD2302220102614";
  document.getElementById("invoiceCurrency").value = "USD";
  document.getElementById("exchangeRate").value = "90.3702";
  document.getElementById("placeOfSupply").value = "Karnataka";

  // Step 3: Client Information
  document.getElementById("clientCompany").value = "Microsoft Corporation";
  document.getElementById("clientPerson").value = "John Smith";
  document.getElementById("clientAddressLine1").value = "One Microsoft Way";
  document.getElementById("clientState").value = "WA";
  document.getElementById("clientCountrySelect").value = "United States of America";
  document.getElementById("clientPinCode").value = "98052";
  document.getElementById("clientEmail").value = "john.smith@microsoft.com";
  document.getElementById("clientGSTIN").value = "Unregistered / Overseas";

  // Step 4: Add one sample item
  document.getElementById("addItemBtn").click();
  setTimeout(() => {
    const item = document.querySelector(".item");
    if (item) {
      item.querySelector(".title").value = "Webflow Website Development";
      item.querySelector(".desc").value = "Custom redesign using selected template, including migration of existing site and setup of 7 pages (Home, About, Contact, Team, Case Study CMS, Podcast CMS, Blog CMS). Includes 2 revision rounds.";
      item.querySelector(".sac").value = "998314";
      item.querySelector(".amt").value = "1050";
      updateItems();
    }
  }, 100);

  // Step 5: Payment Terms
  document.getElementById("supportEmail").value = "invoices@google.com";
  document.getElementById("dueDays").value = "30";
  document.getElementById("paymentLink").value = "";
  document.getElementById("bankDetailsToggle").checked = true;
  document.getElementById("bankContainer").classList.remove("hidden");

  document.getElementById("bankName").value = "HDFC BANK";
  document.getElementById("bankHolder").value = "GOOGLE INDIA PVT LTD";
  document.getElementById("bankNumber").value = "00123456789012";
  document.getElementById("bankIFSC").value = "HDFC0000123";
  document.getElementById("bankBranch").value = "KORAMANGALA, BANGALORE";

  // Step 6: Signature
  document.getElementById("signatureName").value = "Sundar Pichai";
  document.getElementById("signatureTitle").value = "Authorized Signatory";

  // Trigger all updates
  document.getElementById("companyName").dispatchEvent(new Event("input"));
  document.getElementById("gstin").dispatchEvent(new Event("input"));
  document.getElementById("pan").dispatchEvent(new Event("input"));
  document.getElementById("companyAddressLine1").dispatchEvent(new Event("input"));
  document.getElementById("companyCity").dispatchEvent(new Event("input"));
  document.getElementById("companyState").dispatchEvent(new Event("input"));
  document.getElementById("companyCountry").dispatchEvent(new Event("input"));
  document.getElementById("companyPinCode").dispatchEvent(new Event("input"));
  document.getElementById("companyEmail").dispatchEvent(new Event("input"));
  document.getElementById("companyPhone").dispatchEvent(new Event("input"));
  document.getElementById("invoiceNumber").dispatchEvent(new Event("input"));
  document.getElementById("invoiceDate").dispatchEvent(new Event("input"));
  document.getElementById("invoiceCurrency").dispatchEvent(new Event("input"));
  document.getElementById("lutNumber").dispatchEvent(new Event("input"));
  document.getElementById("clientCompany").dispatchEvent(new Event("input"));
  document.getElementById("clientPerson").dispatchEvent(new Event("input"));
  document.getElementById("clientAddressLine1").dispatchEvent(new Event("input"));
  document.getElementById("clientState").dispatchEvent(new Event("input"));
  document.getElementById("clientCountrySelect").dispatchEvent(new Event("input"));
  document.getElementById("clientPinCode").dispatchEvent(new Event("input"));
  document.getElementById("clientEmail").dispatchEvent(new Event("input"));
  document.getElementById("clientGSTIN").dispatchEvent(new Event("input"));
  document.getElementById("placeOfSupply").dispatchEvent(new Event("input"));
  document.getElementById("signatureName").dispatchEvent(new Event("input"));
  document.getElementById("signatureTitle").dispatchEvent(new Event("input"));
  document.getElementById("paymentLink").dispatchEvent(new Event("input"));
  document.getElementById("bankDetailsToggle").dispatchEvent(new Event("change"));
  updatePaymentTerms();
  updateBankDetails();
}

// Load sample data on page load
window.addEventListener("DOMContentLoaded", loadSampleData);
</script>

</body>
</html>
